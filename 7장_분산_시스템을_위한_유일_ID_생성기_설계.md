# 7장: 분산 시스템을 위한 유일 ID 생성기 설계

* 요구사항
    * 아이디는 유일할 것
    * 아이디는 시간이 흐름에 따라 증가할 것
    * 아이디 생성은 고가용성을 유지할 것

* 여러 선택지
    * 티켓 서버: 아이디 생성 역할을 별도의 서버로 분리
    * 트위터 스노우 플레이크: 타임스탬프-데이터센터-서버-일련번호 순서로 아이디 구성

## 티켓 서버
* 모든 분산 서버에서 이용하는 아이디 생성 역할을 별도의 서버로 분리
* 이때, 단일 서버로 이용 시, SPOF(Single Point Of Failure)가 될 수 있음
* 티켓 서버를 다중화하고 ACK 설정을 통해 정족수 합의를 이용할 수 있음
* 리더에 장애가 발생하면 레플리카를 리더로 승급
* 그러나 아이디 생성의 역할은 단일 서버에 할당되기 때문에 분산된 여러 서버에서 아이디 생성을 동시에 요청할 경우, 병목 지점이 될 수 있음

## 트위터 스노우 플레이크
* 타임스탬프-데이터센터id-서버id-일련번호를 통해 아이디를 생성함
* 일련 번호는 하나의 서버에서 동일한 ms 내에 발생한 여러 아이디 생성 요청 간 순서 설정을 위해 이용

## 트위터 스노우 플레이크와 같은 분선 시스템에서 시간 동기화 방법 (NTP: Network Time Protocol)
* 서버 시간을 기준으로 클라이언트 시간을 동기화
* 이때, 네트워크 지연 시간을 반영(네트워크 지연은 일정하다고 가정)
* 네트워크 지연 시간은 클라이언트의 요청 전송 시간, 응답 수신 시간, 서버의 요청 수신 시간, 응답 전송 시간을 기준으로 측정함